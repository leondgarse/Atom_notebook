```py
import torch
from models.experimental import attempt_load
model = attempt_load('./weights/yolov5s-face.pt', map_location=torch.device("cpu"))
out = model(torch.ones([1, 3, 640, 640]))
out[0].shape
```
```sh
CUDA_VISIBLE_DEVICES='-1' python models/tf_keras.py --weights yolov5s.pt
CUDA_VISIBLE_DEVICES='-1' python models/tf_keras.py --weights ../yolov5-face/weights/yolov5s-face.pt --imgsz 640 384
```
```sh
CUDA_VISIBLE_DEVICES='-1' python detect_face.py --weights weights/yolov5s-face.pt --image data/images/bus.jpg && eog result.jpg
```
```py
{"class_name": "TFOpLambda", "config": {"name": "tf.split", "trainable": true, "dtype": "float32", "function": "split"}, "name": "tf.split", "inbound_nodes": [["reshape_1", 0, 0, {"num_or_size_splits": 2, "axis": -1}]]}
{"name": "tf_op_layer_split", "class_name": "TensorFlowOpLayer", "config": {"name": "split", "trainable": true, "dtype": null, "node_def": {"name": "split", "op": "Split", "input": ["split/split_dim", "input_2"], "attr": {"T": {"type": "DT_FLOAT"}, "num_split": {"i": "2"}}}, "constants": {"0": -1}}, "inbound_nodes": [[["input_2", 0, 0, {}]]]}
```
- **ncnn** [Github FeiGeChuanShu/ncnn_Android_face](https://github.com/FeiGeChuanShu/ncnn_Android_face)
```sh
adb push ncnn-android-yolov5_face/app/src/main/assets/* /data/local/tmp/benchmark/
adb push ncnn-android-scrfd-master/app/src/main/assets/scrfd_* /data/local/tmp/benchmark/

adb shell 'cd /data/local/tmp/benchmark; LD_LIBRARY_PATH=.. ./benchncnn'
#         yolov5n  min =  196.79  max =  201.00  avg =  199.21
#     yolov5n-0.5  min =   96.08  max =   99.87  avg =   97.52
#   scrfd_1g-opt2  min =  116.02  max =  128.08  avg =  120.76
# scrfd_500m-opt2  min =   69.49  max =   71.69  avg =   70.34
```
**rk3288, ARM32, 640x384**
```sh
adb shell 'cd /data/local/tmp/benchmark; LD_LIBRARY_PATH=.. ./benchncnn'
#         yolov5n  min = 2578.02  max = 3152.46  avg = 2871.29
#     yolov5n-0.5  min = 1052.76  max = 1577.13  avg = 1393.49
#   scrfd_1g-opt2  min =  985.31  max = 1576.60  avg = 1171.01
# scrfd_500m-opt2  min =  531.48  max =  883.14  avg =  689.63

adb shell 'cd /data/local/tmp/benchmark; LD_LIBRARY_PATH=.. ./benchncnn 4 1'
#         yolov5n  min = 1738.41  max = 2040.99  avg = 1892.60
#     yolov5n-0.5  min =  505.12  max =  615.21  avg =  557.84
#   scrfd_1g-opt2  min =  756.70  max = 1089.44  avg =  891.28
# scrfd_500m-opt2  min =  408.14  max =  524.41  avg =  440.87

adb shell 'cd /data/local/tmp/benchmark; LD_LIBRARY_PATH=.. ./benchncnn 4 2'
#         yolov5n  min = 1662.97  max = 2468.14  avg = 1996.67
#     yolov5n-0.5  min =  651.80  max =  829.82  avg =  750.46
#   scrfd_1g-opt2  min =  292.47  max =  299.20  avg =  295.30
# scrfd_500m-opt2  min =  148.88  max =  149.20  avg =  149.04
```
**rk3288, ARM32, 320x192**
```sh
adb shell 'cd /data/local/tmp/benchmark; LD_LIBRARY_PATH=.. ./benchncnn 4 4'
#         yolov5n  min =  112.15  max =  181.31  avg =  136.74
#     yolov5n-0.5  min =   37.07  max =   62.95  avg =   43.65
#   scrfd_1g-opt2  min =   47.94  max =   82.00  avg =   63.76
# scrfd_500m-opt2  min =   25.27  max =   44.65  avg =   32.72
```
- **tflite**
```sh
!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-face.tflite --num_threads=4 --use_xnnpack=true
# count=50 first=236744 curr=228642 min=221046 max=236985 avg=226324 std=3807
# Inference timings in us: Init: 90791, First inference: 277454, Warmup (avg): 251886, Inference (avg): 226324
!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-face.tflite --num_threads=8 --use_xnnpack=true
# count=50 first=187881 curr=177890 min=172574 max=273037 avg=179291 std=14146
# Inference timings in us: Init: 97564, First inference: 267559, Warmup (avg): 206443, Inference (avg): 179291

!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-0.5.tflite --num_threads=4 --use_xnnpack=true
# count=50 first=92541 curr=91487 min=90599 max=99438 avg=93417.7 std=1839
# Inference timings in us: Init: 38974, First inference: 127805, Warmup (avg): 99338.4, Inference (avg): 93417.7
!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-0.5.tflite --num_threads=8 --use_xnnpack=true
# count=50 first=79314 curr=79861 min=76824 max=85946 avg=79621.6 std=1907
# Inference timings in us: Init: 46040, First inference: 156502, Warmup (avg): 130180, Inference (avg): 79621.6
```
- **tflite TF15 (640, 384)**
```sh
!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-0.5_tf15.tflite --num_threads=4 --use_xnnpack=true
# count=50 first=86489 curr=87436 min=85356 max=92507 avg=87459.7 std=998
# Inference timings in us: Init: 38842, First inference: 118425, Warmup (avg): 92578, Inference (avg): 87459.7
!adb shell /data/local/tmp/benchmark_model --graph=/data/local/tmp/yolov5n-0.5_tf15.tflite --num_threads=8 --use_xnnpack=true
# count=50 first=73698 curr=70552 min=68299 max=81571 avg=70767.2 std=2227
# Inference timings in us: Init: 40680, First inference: 141210, Warmup (avg): 86868.7, Inference (avg): 70767.2
```
- **tflite TF15 with decode**

| model        | input    | model size (MB) | num_threads 4 (ms) | num_threads 8 (ms) |
| ------------ | -------- | --------------- | ------------------ | ------------------ |
| yolov5n-face | 640, 384 | 3.67216         | 265.224            | 221.162            |
| yolov5n-face | 480, 288 | 3.61924         | 144.718            | 121.121            |
| yolov5n-face | 320, 192 | 3.58144         | 61.383             | 54.496             |
| yolov5n-0.5  | 640, 384 | 1.12552         | 115.085            | 104.037            |
| yolov5n-0.5  | 480, 288 | 1.0726          | 61.272             | 55.854             |
| yolov5n-0.5  | 320, 192 | 1.0348          | 25.319             | 24.410             |

- **rk3288, ARM32**

| model        | input    | model size (MB) | num_threads 4 (ms) | num_threads 8 (ms) |
| ------------ | -------- | --------------- | ------------------ | ------------------ |
| yolov5n-face | 640, 384 | 3.67216         |                    |                    |
| yolov5n-face | 480, 288 | 3.61924         |                    |                    |
| yolov5n-face | 320, 192 | 3.58144         |                    |                    |
| yolov5n-0.5  | 640, 384 | 1.12552         |                    |                    |
| yolov5n-0.5  | 480, 288 | 1.0726          |                    |                    |
| yolov5n-0.5  | 320, 192 | 1.0348          | 38208.6            |                    |
