```sh
pip install --extra-index-url https://developer.download.nvidia.com/compute/redist --upgrade nvidia-dali-cuda120
```
```py
from nvidia.dali.pipeline import Pipeline

from nvidia.dali import pipeline_def
import nvidia.dali.fn as fn
import nvidia.dali.types as types

image_dir = "data/images"
max_batch_size = 8

@pipeline_def
def simple_pipeline():
    jpegs, labels = fn.readers.file(file_root=image_dir)
    images = fn.decoders.image(jpegs, device='cpu')

    return images, labels
```
```py
import os
import numpy as np
import matplotlib.pyplot as plt
from tqdm import tqdm

dataset_path, num_classes, images_per_class, input_shape = "fake_data", 100, 50, (224, 224, 3)
os.makedirs(dataset_path, exist_ok=True)
for cur_class in tqdm(range(num_classes), "Generating fake data"):
    cur_dir = os.path.join(dataset_path, str(cur_class))
    os.makedirs(cur_dir, exist_ok=True)
    for id in range(images_per_class):
        image = np.random.uniform(0, 1, size=input_shape)
        plt.imsave(os.path.join(cur_dir, "{}.jpg".format(id)), image)
```
